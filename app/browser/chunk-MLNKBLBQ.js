import{a as ge}from"./chunk-NKCHFV7Q.js";import{a as D}from"./chunk-5JQIFG63.js";import{a as _e,b as fe}from"./chunk-XGV4AIQT.js";import{c as B}from"./chunk-6CXWHLUJ.js";import"./chunk-SBLJNY6Q.js";import"./chunk-EA4RMISB.js";import{b as de}from"./chunk-P4HR6EQA.js";import{e as F}from"./chunk-NEQPNYWW.js";import{c as V}from"./chunk-AFTSMEUE.js";import{F as he,j as me,p as ce,q as ue,u as I}from"./chunk-LBGQA5HW.js";import{b as Z}from"./chunk-4A2WLUYH.js";import{c as pe}from"./chunk-VVKQAEX7.js";import{a as ne,b as oe}from"./chunk-FW7KDDDM.js";import{Ba as z,C as _,Ca as Q,D as R,Da as A,E as w,Ea as P,Eb as j,Fa as d,Ga as h,Ha as S,Ja as C,K as c,Ka as T,L as u,La as M,Oa as N,Sb as J,Vb as X,Wb as Y,Xa as s,Y as n,Ya as l,Yb as $,ac as ee,da as x,db as q,fc as te,ga as L,ia as f,lc as ie,mb as G,nb as K,oa as i,pa as o,pb as U,qa as y,ua as H,va as v,wa as k,wc as re,xc as ae,y as W,yc as se,z as E,zc as le}from"./chunk-DSVZHE42.js";import"./chunk-GAL4ENT6.js";var xe=(()=>{class t{constructor(){this.http=_(U),this.api=_(Y),this.notificationService=_(X),this.dateService=_(V),this.reportsService=_(ge),this.decimalService=_(F),this.expenses=x([]),this.loading_table=x(!1),this.user_balance=x({}),this.laoding_balance=x(!1),this.expenseNumber=x(null),this.from_date=x(this.dateService.getStartOfMonth()),this.to_date=x(this.dateService.getCurrentDate()),this.loadingTotalExpenses=x(!1),this.totalExpenses=q(()=>this.expenses().reduce((r,p)=>this.decimalService.add(r,p.total_value),0)),this.getExpenses()}getExpenses(){this.loading_table.set(!0);let r=this.from_date()?this.dateService.formatDate(this.from_date(),"yyyy-MM-dd"):null,p=this.to_date()?this.dateService.formatDate(this.to_date(),"yyyy-MM-dd"):null,e={expense:this.expenseNumber(),start:r,end:p};this.http.post(`${this.api.host()}/expense`,e).subscribe({next:a=>{this.expenses.set(a),this.loading_table.set(!1)},error:a=>{this.notificationService.showError(a.error,"home"),this.loading_table.set(!1)}})}static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275prov=W({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var be=()=>[10,25,50],Ee=()=>["journal_number","journal_description","payment_date"];function we(t,b){t&1&&(i(0,"tr")(1,"th",34),d(2),s(3,"translate"),o(),i(4,"th",35),d(5),s(6,"translate"),o(),i(7,"th",36),d(8),s(9,"translate"),o(),i(10,"th",34),d(11),s(12,"translate"),o(),i(13,"th",34),d(14),s(15,"translate"),o()()),t&2&&(n(2),S("",l(3,5,"Expense")," #"),n(3),h(l(6,7,"Description")),n(3),h(l(9,9,"Datetime")),n(3),h(l(12,11,"Total")),n(3),h(l(15,13,"Options")))}function Ce(t,b){if(t&1){let r=H();i(0,"tr")(1,"td"),d(2),o(),i(3,"td"),d(4),o(),i(5,"td"),d(6),o(),i(7,"td"),d(8),s(9,"currency"),o(),i(10,"td")(11,"p-button",37),v("onClick",function(){let e=c(r).$implicit,a=k();return u(a.openEditDialog(e))}),o()()()}if(t&2){let r=b.$implicit;n(2),h(r.journal_number),n(2),h(r.journal_description),n(2),h(r.payment_date),n(2),h(l(9,4,r.total_value))}}function Te(t,b){if(t&1&&(i(0,"tr"),y(1,"td",38),i(2,"td"),d(3),s(4,"translate"),i(5,"span",39),d(6),s(7,"currency"),o()(),y(8,"td"),o()),t&2){let r=k();n(3),S(" ",l(4,2,"Total:")," "),n(3),h(l(7,4,r.totalFilteredExpenses))}}function Me(t,b){t&1&&(i(0,"tr")(1,"td",40),d(2),s(3,"translate"),o()()),t&2&&(n(2),S(" ",l(3,1,"No Records Found!")," "))}var ve=(()=>{class t{constructor(){this.userService=_(Z),this.expensesService=_(xe),this.dateService=_(V),this.decimalService=_(F),this.expenses=this.expensesService.expenses,this.expenses_dialog_visible=!1,this.loading=this.expensesService.loading_table,this.loading_balance=this.expensesService.laoding_balance,this.dialog_mode="add",this.balance=this.expensesService.user_balance,this.userType=this.userService.userType,this.expenseNumber=this.expensesService.expenseNumber,this.from_date=this.expensesService.from_date,this.to_date=this.expensesService.to_date,this.loadingTotalExpenses=this.expensesService.loadingTotalExpenses,this.totalExpenses=this.expensesService.totalExpenses,this.totalFilteredExpenses=0}submit(r){r.key==="Enter"&&this.submitSearch()}submitSearch(){this.expensesService.getExpenses(),this.totalFilteredExpenses==0&&setTimeout(()=>{this.totalFilteredExpenses=this.calculateTotal(this.expenses()||[])},500)}clearSearch(){this.expensesService.expenseNumber.set(null),this.expensesService.from_date.set(null),this.expensesService.to_date.set(null)}addExpense(){this.dialog_mode="add",this.expenses_dialog_visible=!0}openEditDialog(r){this.dialog_mode="edit",this.selected_payment=r,this.expenses_dialog_visible=!0}closeDialog(){this.expenses_dialog_visible=!1}onFilter(r){this.totalFilteredExpenses=this.calculateTotal(r.filteredValue)}calculateTotal(r){return console.log(r),r.reduce((p,e)=>this.decimalService.add(p,parseFloat(e.total_value)),0)}static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275cmp=R({type:t,selectors:[["app-expenses-home"]],viewQuery:function(p,e){if(p&1&&z(I,5),p&2){let a;Q(a=A())&&(e.ct=a.first)}},decls:63,vars:69,consts:[["tableSearch",""],["ct",""],[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-12","lg:col-9"],[3,"legend","toggleable"],[1,"col-12","md:col-6","lg:col-3","flex","flex-column","gap-2"],["type","search","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full",3,"ngModelChange","keyup","ngModel","placeholder"],["styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","placeholder","showButtonBar"],[1,"col-12","md:col-6","lg:col-3","flex","align-items-end"],["type","submit","icon","pi pi-search","size","small","severity","success","styleClass","mr-2",3,"onClick","label","loading"],["icon","pi pi-times","size","small","severity","danger",3,"onClick","label","disabled"],[1,"col-12","lg:col-3","align-self-center"],[1,"surface-card","shadow-2","p-3","border-round"],[1,"flex","justify-content-between","mb-1"],[1,"block","text-500","font-medium","mb-3"],["loaderStyle","w-2rem h-2rem",3,"isLoading"],[1,"text-red-600","font-medium","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-red-100","border-round",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-dollar","text-red-600","text-xl"],[1,"grid","mb-2"],[1,"col-7","md:col-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["id","globalFilter","pInputText","","spellcheck","false","type","search",1,"p-inputtext-sm","w-full",3,"input","placeholder","value"],[1,"col-6","md:col-2"],["severity","success","icon","pi pi-plus","size","small","styleClass","w-full",3,"onClick","label"],["dataKey","order_id","styleClass","p-datatable-sm",3,"onFilter","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[3,"OnClose","OnSubmit","visible","selected_payment","dialog_mode"],["width","10%"],["width","50%"],["width","20%"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["colspan","3"],[1,"text-red-600"],["colspan","11"]],template:function(p,e){if(p&1){let a=H();i(0,"div",2)(1,"div",3)(2,"p-card")(3,"div",4)(4,"div",5)(5,"p-fieldset",6),s(6,"translate"),i(7,"div",4)(8,"div",7)(9,"label"),d(10),s(11,"translate"),o(),i(12,"input",8),s(13,"translate"),M("ngModelChange",function(m){return c(a),T(e.expenseNumber,m)||(e.expenseNumber=m),u(m)}),v("keyup",function(m){return c(a),u(e.submit(m))}),o()(),i(14,"div",7)(15,"label"),d(16),s(17,"translate"),o(),i(18,"p-calendar",9),s(19,"translate"),M("ngModelChange",function(m){return c(a),T(e.from_date,m)||(e.from_date=m),u(m)}),o()(),i(20,"div",7)(21,"label"),d(22),s(23,"translate"),o(),i(24,"p-calendar",9),s(25,"translate"),M("ngModelChange",function(m){return c(a),T(e.to_date,m)||(e.to_date=m),u(m)}),o()(),i(26,"div",10)(27,"p-button",11),s(28,"translate"),v("onClick",function(){return c(a),u(e.submitSearch())}),o(),i(29,"p-button",12),s(30,"translate"),v("onClick",function(){return c(a),u(e.clearSearch())}),o()()()()(),i(31,"div",13)(32,"div",14)(33,"div",15)(34,"div")(35,"span",16),d(36),s(37,"translate"),o(),i(38,"text-with-loading",17)(39,"div",18),d(40),s(41,"currency"),o()()(),i(42,"div",19),y(43,"i",20),o()()()()()()(),i(44,"div",3)(45,"p-card")(46,"div",21)(47,"div",22)(48,"span",23),y(49,"i",24),i(50,"input",25,0),s(52,"translate"),v("input",function(m){c(a);let ye=P(57);return u(ye.filterGlobal(m.target.value,"contains"))}),o()()(),i(53,"div",26)(54,"p-button",27),s(55,"translate"),v("onClick",function(){return c(a),u(e.addExpense())}),o()()(),i(56,"p-table",28,1),v("onFilter",function(m){return c(a),u(e.onFilter(m))}),L(58,we,16,15,"ng-template",29)(59,Ce,12,6,"ng-template",30)(60,Te,9,6,"ng-template",31)(61,Me,4,3,"ng-template",32),o()()()(),i(62,"expenses-dialog",33),v("OnClose",function(){return c(a),u(e.closeDialog())})("OnSubmit",function(){return c(a),u(e.submitSearch())}),o()}if(p&2){let a=P(57);n(5),f("legend",l(6,41,"Search Form"))("toggleable",!1),n(5),S("",l(11,43,"Expense")," #"),n(2),C("ngModel",e.expenseNumber),f("placeholder",l(13,45,"Expense")),n(4),h(l(17,47,"Start Date")),n(2),C("ngModel",e.from_date),f("showIcon",!1)("showClear",!0)("readonlyInput",!0)("placeholder",l(19,49,"Start Date"))("showButtonBar",!0),n(4),h(l(23,51,"End Date")),n(2),C("ngModel",e.to_date),f("showIcon",!1)("showClear",!0)("readonlyInput",!0)("placeholder",l(25,53,"End Date"))("showButtonBar",!0),n(3),f("label",l(28,55,"Search"))("loading",e.loading()),n(2),f("label",l(30,57,"Reset"))("disabled",e.loading()),n(7),h(l(37,59,"Total Expenses")),n(2),f("isLoading",e.loadingTotalExpenses()),n(2),S(" ",l(41,61,e.totalExpenses()||0)," "),n(10),f("placeholder",l(52,63,"Search in results"))("value",a.filters.global==null?null:a.filters.global.value),n(4),f("label",l(55,65,"Add Expense")),n(2),f("value",e.expenses())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",N(67,be))("alwaysShowPaginator",!0)("loading",e.loading())("globalFilterFields",N(68,Ee))("filterDelay",0),n(6),f("visible",e.expenses_dialog_visible)("selected_payment",e.selected_payment)("dialog_mode",e.dialog_mode)}},dependencies:[$,ee,te,re,J,D,ne,I,ce,_e,se,B,G,pe],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding-top:.5rem!important;padding-bottom:.5rem!important}[_nghost-%COMP%]  .p-fieldset .p-fieldset-legend{padding-top:.8rem!important;padding-bottom:.8rem!important}[_nghost-%COMP%]  .p-card .p-card-content{padding:.75rem 0!important}"]})}}return t})();var Be=[{path:"",component:ve}],Se=(()=>{class t{static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275mod=w({type:t})}static{this.\u0275inj=E({imports:[j.forChild(Be),j]})}}return t})();var Et=(()=>{class t{static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275mod=w({type:t})}static{this.\u0275inj=E({imports:[K,ie,Se,ae,D,oe,he,ue,me,fe,le,de,B]})}}return t})();export{Et as ExpensesModule};
