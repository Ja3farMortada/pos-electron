import{a as p}from"./chunk-IQTEOPEP.js";import{a as d}from"./chunk-SBLJNY6Q.js";import{d as m}from"./chunk-NEQPNYWW.js";import{C as r,Vb as u,Wb as f,d as o,da as t,eb as h,pb as l,y as c}from"./chunk-DSVZHE42.js";var v=class{constructor(){this.cost_dollar=0,this.subtotal_dollar=0,this.total_dollar=0,this.total_qty=0}},S=function(e){return e.unit_price_usd="unit_price_usd",e.whole_price_usd="whole_price_usd",e}(S||{});var H=(()=>{class e{submitBarcode(s){this.http.get(`${this.apiService.host()}/stock/item/${s}`).subscribe({next:i=>{i?this.barcodeResponse.next(i):this.notificationService.showError("Item not found!","home")},error:i=>{this.notificationService.handleError(i.error,"home")}})}checkout(s,i,_){this.signal_submited.set(!0),this.signal_submit_loading.set(!0);let n=null;s.partner_id_fk&&i&&(n={amount:i,partner_id_fk:s.partner_id_fk,payment_date:s.order_datetime}),this.http.post(`${this.apiService.host()}/supply`,{invoice:s,payment:n,modify_cash:_}).subscribe({next:a=>{this.notificationService.showSuccess("Invoice submitted","home")},error:a=>{this.notificationService.showError(a.error.message,"home"),this.signal_submit_loading.set(!1)},complete:()=>{this.stockService.getProducts(),this.invoice.set([]),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.reset$.next(!0),this.customerDialogVisible.set(!1),this.cashBalanceService.getBalance(),this.historyService.fetchPurchasesHistory()}})}constructor(){this.http=r(l),this.apiService=r(f),this.notificationService=r(u),this.stockService=r(m),this.cashBalanceService=r(d),this.historyService=r(p),this.invoice=t([]),this.selected_supplier_id=t(null),this.payment_amount=t(0),this.lbp_payment_amount=t(0),this.modify_cash=t(!0),this.signal_submited=t(!1),this.signal_submit_loading=t(!1),this.reset$=new o(!1),this.factor=t(1),this.barcodeResponse=new o(null),this.customerDialogVisible=t(!1),this.inventories=this.stockService.inventories,this.loadingInventories=this.stockService.loadingInventories,this.defaultInventory=this.stockService.defaultInventory,this.selectedInventoryId=t(this.defaultInventory()),h(()=>{this.selectedInventoryId.set(this.defaultInventory())},{allowSignalWrites:!0})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{v as a,S as b,H as c};
