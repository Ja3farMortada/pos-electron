import{a as Mt,b as Ft}from"./chunk-TXX4AOP3.js";import{a as Qe}from"./chunk-BQGUVE6T.js";import{a as be}from"./chunk-BMSQ5BCO.js";import{a as ee,b as _t}from"./chunk-23C7B2M2.js";import{a as Ae,b as qe,c as ye}from"./chunk-OX3TH2OU.js";import{a as Vt}from"./chunk-FPREGWMZ.js";import{a as Pt}from"./chunk-ARZ4TFMZ.js";import{a as Dt,b as Bt}from"./chunk-B5UDKY34.js";import"./chunk-HV2OQ7WI.js";import"./chunk-FA4OBAKY.js";import"./chunk-EA4RMISB.js";import{a as Et}from"./chunk-OY4T6UDA.js";import{b as Tt,d as xt}from"./chunk-7ZNGIE4A.js";import{a as It}from"./chunk-FO7TG3S7.js";import{a as Ce,b as je}from"./chunk-42BTCZ3Y.js";import{b as Ue}from"./chunk-7QYRFDGN.js";import{a as Me,b as kt}from"./chunk-PIXVAYN4.js";import"./chunk-7KO4RDVD.js";import{a as ze}from"./chunk-UJ5JDQTE.js";import"./chunk-ZPRVI3IV.js";import{a as wt}from"./chunk-UVEVFGTS.js";import"./chunk-P4HR6EQA.js";import{c as St,d as M}from"./chunk-NEQPNYWW.js";import"./chunk-AFTSMEUE.js";import{D as bt,E as vt,F as He,f as gt,g as ht,i as ne,j as he,l as We,m as Oe,u as z,v as Ct,w as yt,x as U}from"./chunk-LBGQA5HW.js";import"./chunk-4A2WLUYH.js";import{b as G,c as B}from"./chunk-VVKQAEX7.js";import{a as Le,b as Ne}from"./chunk-FW7KDDDM.js";import{Ba as W,C,Ca as R,D as T,Da as L,Dc as Xe,E as le,Ea as N,Eb as Ye,Fa as f,Fc as $e,Ga as b,Ha as x,Ic as et,J as Ee,Ja as S,Jb as A,K as u,Ka as w,L as _,La as k,Na as Y,Oa as V,P as K,Pa as ae,Pc as ft,Qa as Ie,Qc as te,Rc as ie,Sb as E,Tb as Je,Vb as X,Wb as Be,X as rt,Xa as c,Y as r,Ya as d,Yb as Fe,_b as q,ac as O,bc as ce,da as at,db as pt,eb as ct,fc as de,ga as I,gb as J,gc as me,hc as ue,ia as l,ib as pe,ic as _e,ka as st,kc as Q,la as Z,lb as dt,lc as Re,mb as De,mc as fe,nb as j,oa as n,pa as o,qa as v,r as Ve,ua as P,uc as ut,va as g,wa as y,wc as D,xb as mt,xc as $,yc as H,z as se,za as lt,zc as ge}from"./chunk-DSVZHE42.js";import"./chunk-GAL4ENT6.js";var Yt=()=>({width:"75vw"}),Jt=()=>({"1199px":"85vw","575px":"95vw"}),Xt=()=>[10,15,50,100],$t=()=>["product_name","barcode"],ei=(i,h)=>({"text-red-500":i,"text-green-600":h});function ti(i,h){i&1&&(n(0,"tr")(1,"th"),f(2),c(3,"translate"),o(),n(4,"th"),f(5),c(6,"translate"),o(),n(7,"th"),f(8),c(9,"translate"),o(),n(10,"th"),f(11),c(12,"translate"),o(),n(13,"th"),f(14),c(15,"translate"),o()()),i&2&&(r(2),b(d(3,5,"Transaction #")),r(3),b(d(6,7,"Datetime")),r(3),b(d(9,9,"Type")),r(3),b(d(12,11,"Quantity")),r(3),b(d(15,13,"Balance")))}function ii(i,h){if(i&1&&(n(0,"tr",8)(1,"td"),f(2),o(),n(3,"td"),f(4),o(),n(5,"td"),v(6,"p-tag",9),c(7,"translate"),o(),n(8,"td",10),f(9),o(),n(10,"td",11),f(11),o()()),i&2){let t=h.$implicit,a=y(2);l("pSelectableRow",t),r(2),x(" ",t.transaction_notes||"---"," "),r(2),b(t.transaction_datetime),r(2),l("value",d(7,8,t.transaction_type))("severity",a.getSeverity(t.transaction_type)),r(2),l("ngClass",Ie(10,ei,t.quantity<0,t.quantity>0)),r(),x(" ",t.quantity," "),r(2),b(t.balance)}}function ni(i,h){i&1&&(n(0,"tr")(1,"td",12),f(2,"No items yet!"),o()())}function oi(i,h){if(i&1&&(n(0,"p-table",4,0),I(2,ti,16,15,"ng-template",5)(3,ii,12,13,"ng-template",6)(4,ni,3,0,"ng-template",7),o()),i&2){let t=y();l("value",t.stockHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",V(8,Xt))("alwaysShowPaginator",!0)("globalFilterFields",V(9,$t))("filterDelay",0)}}function ri(i,h){if(i&1){let t=P();n(0,"p-button",13),c(1,"translate"),g("onClick",function(){u(t);let e=y();return _(e.closeDialog())}),o()}i&2&&l("label",d(1,1,"Cancel"))}var Se=(()=>{class i{constructor(){this.visible=!1,this.onClose=new K,this.stockService=C(M),this.stockHistory=this.stockService.stockHistory}closeDialog(){this.visible=!1,this.onClose.emit()}fetchProductHistory(){this.stockService.fetchStockHistory(this.product_id)}getSeverity(t){switch(t){case"SALE":return"primary";case"SUPPLY":return"info";case"RETURN":return"warning";case"DELETE":return"contrast";case"DISPOSE":return"danger";case"ADD":return"success";case"REMOVE":return"danger";default:return"contrast"}}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["stock-transactions"]],inputs:{product_id:"product_id",visible:"visible"},outputs:{onClose:"onClose"},standalone:!0,features:[Y],decls:4,vars:14,consts:[["dt2",""],["position","top","styleClass","p-fluid",3,"visibleChange","onHide","onShow","header","modal","visible","breakpoints","closeOnEscape","closable","maximizable","dismissableMask"],["pTemplate","content"],["pTemplate","footer"],["styleClass","p-datatable-sm","dataKey","transaction_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"pSelectableRow"],[3,"value","severity"],[1,"font-bold",3,"ngClass"],[1,"font-bold"],["colspan","7"],["icon","pi pi-times","severity","secondary","size","small","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","label"]],template:function(a,e){a&1&&(n(0,"p-dialog",1),c(1,"translate"),k("visibleChange",function(p){return w(e.visible,p)||(e.visible=p),p}),g("onHide",function(){return e.closeDialog()})("onShow",function(){return e.fetchProductHistory()}),I(2,oi,5,10,"ng-template",2)(3,ri,2,3,"ng-template",3),o()),a&2&&(Z(V(12,Yt)),l("header",d(1,10,"Transaction History"))("modal",!0),S("visible",e.visible),l("breakpoints",V(13,Jt))("closeOnEscape",!0)("closable",!0)("maximizable",!0)("dismissableMask",!0))},dependencies:[ie,te,E,$,D,He,z,U,Bt,Dt,B,j,J]})}}return i})();var si=()=>({width:"65vw"}),it=i=>({"ng-invalid ng-dirty":i});function li(i,h){if(i&1){let t=P();n(0,"form",3),g("ngSubmit",function(){u(t);let e=y();return _(e.submitStockCorrection())}),n(1,"div",4)(2,"div",5)(3,"label"),f(4),c(5,"translate"),n(6,"span",6),f(7,"*"),o()(),v(8,"p-dropdown",7),c(9,"translate"),o(),n(10,"div",5)(11,"label"),f(12),c(13,"translate"),n(14,"span",6),f(15,"*"),o()(),v(16,"p-inputNumber",8),o(),n(17,"div",9)(18,"label"),f(19),c(20,"translate"),n(21,"span",6),f(22,"*"),o()(),v(23,"input",10),o()()()}if(i&2){let t=y();l("formGroup",t.correctStockForm),r(4),b(d(5,12,"Option")),r(4),l("autoOptionFocus",!1)("options",t.transactionOptions)("placeholder",d(9,14,"transaction type"))("ngClass",ae(20,it,t.f.transaction_type.invalid&&(t.f.transaction_type.dirty||t.f.transaction_type.touched||t.submitted))),r(4),b(d(13,16,"Quantity")),r(4),l("maxFractionDigits",2)("minFractionDigits",0)("ngClass",ae(22,it,t.f.quantity.invalid&&(t.f.quantity.dirty||t.f.quantity.touched||t.submitted))),r(3),b(d(20,18,"Notes")),r(4),l("ngClass",ae(24,it,t.f.transaction_notes.invalid&&(t.f.transaction_notes.dirty||t.f.transaction_notes.touched||t.submitted)))}}function pi(i,h){if(i&1){let t=P();n(0,"p-button",11),c(1,"translate"),g("onClick",function(){u(t);let e=y();return _(e.closeStockCorrectionDialog())}),o(),n(2,"p-button",12),c(3,"translate"),g("onClick",function(){u(t);let e=y();return _(e.submitStockCorrection())}),o()}if(i&2){let t=y();l("label",d(1,3,"Cancel")),r(2),l("label",d(3,5,"Save"))("loading",t.loading)}}var we=(()=>{class i{constructor(){this.fb=C(Q),this.apiService=C(Be),this.notification=C(X),this.translate=C(G),this.visible=!1,this.visibleChange=new K,this.onSubmit=new K,this.loading=!1,this.transactionOptions=[{name:this.translate.instant("Add"),value:"ADD"},{name:this.translate.instant("Remove"),value:"REMOVE"}],this.submitted=!1,this.correctStockForm=this.fb.group({product_id_fk:[null,q.required],transaction_type:[{value:null,disabled:!1},q.required],quantity:[null,q.required],transaction_notes:[null,q.required],inventory_id:[null,q.required]})}ngOnChanges(t){t.visible&&this.visible&&this.correctStockForm.reset({product_id_fk:this.product_id,inventory_id:this.inventory_id})}get f(){return this.correctStockForm.controls}closeStockCorrectionDialog(){this.submitted=!1,this.visibleChange.emit(!1),this.loading=!1}submitStockCorrection(){this.submitted=!0,this.correctStockForm.valid&&(this.loading=!0,this.apiService.post("stock/correction",this.correctStockForm.value).pipe(Ve(()=>{this.loading=!1})).subscribe({next:t=>{this.notification.showSuccess(),this.onSubmit.emit(t),this.closeStockCorrectionDialog()}}))}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["stock-correction"]],inputs:{visible:"visible",product_id:"product_id",inventory_id:"inventory_id"},outputs:{visibleChange:"visibleChange",onSubmit:"onSubmit"},standalone:!0,features:[Ee,Y],decls:4,vars:8,consts:[["styleClass","p-fluid","position","top",3,"visibleChange","onHide","visible","header","modal"],["pTemplate","content"],["pTemplate","footer"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-3"],[1,"text-red-600"],["scrollHeight","400px","appendTo","body","formControlName","transaction_type","optionLabel","name","optionValue","value",3,"autoOptionFocus","options","placeholder","ngClass"],["formControlName","quantity","autoSelect","","min","0.1","step","0.1",3,"maxFractionDigits","minFractionDigits","ngClass"],[1,"field","col-12","md:col-6"],["type","text","spellcheck","false","pInputText","","formControlName","transaction_notes",1,"w-full",3,"ngClass"],["icon","pi pi-times","severity","secondary","size","small",3,"onClick","label"],["icon","pi pi-check","severity","success","size","small",3,"onClick","label","loading"]],template:function(a,e){a&1&&(n(0,"p-dialog",0),c(1,"translate"),k("visibleChange",function(p){return w(e.visible,p)||(e.visible=p),p}),g("onHide",function(){return e.closeStockCorrectionDialog()}),I(2,li,24,26,"ng-template",1)(3,pi,4,7,"ng-template",2),o()),a&2&&(Z(V(7,si)),S("visible",e.visible),l("header",d(1,5,"Stock Correction"))("modal",!0))},dependencies:[j,J,ie,te,E,$,D,ge,H,he,ne,fe,me,Fe,O,ce,ue,_e,Oe,We,B,wt]})}}return i})();var _i=["tableSearch"],fi=["barcodeInput"],gi=["itemName"],hi=["dt2"],Ci=()=>[10,15,20,50,100],yi=()=>["product_name","barcode","sku"];function bi(i,h){i&1&&(n(0,"th",40),f(1),c(2,"translate"),o()),i&2&&(r(),x(" ",d(2,1,"Latest Cost")," "))}function vi(i,h){i&1&&(n(0,"th",40),f(1),c(2,"translate"),o()),i&2&&(r(),x(" ",d(2,1,"Avg Cost")," "))}function Si(i,h){i&1&&(n(0,"th",40),f(1),c(2,"translate"),o()),i&2&&(r(),x(" ",d(2,1,"Wholesale")," "))}function wi(i,h){if(i&1&&(n(0,"tr")(1,"th",27),f(2),c(3,"translate"),v(4,"p-sortIcon",28),o(),n(5,"th",29),f(6),c(7,"translate"),v(8,"p-sortIcon",30),o(),n(9,"th",31),f(10),c(11,"translate"),v(12,"p-sortIcon",32),o(),n(13,"th",33),f(14),c(15,"translate"),v(16,"p-sortIcon",34),o(),n(17,"th",35),f(18),c(19,"translate"),v(20,"p-sortIcon",36),o(),n(21,"th",37),f(22),c(23,"translate"),v(24,"p-sortIcon",38),o(),I(25,bi,3,3,"th",39)(26,vi,3,3,"th",39),n(27,"th",40),f(28),c(29,"translate"),o(),I(30,Si,3,3,"th",39),n(31,"th",40),f(32),c(33,"translate"),o()()),i&2){let t=y();r(2),x(" ",d(3,11,"SKU")," "),r(4),x(" ",d(7,13,"Barcode")," "),r(4),x(" ",d(11,15,"Description")," "),r(4),x(" ",d(15,17,"Category")," "),r(4),x(" ",d(19,19,"Brand")," "),r(4),x(" ",d(23,21,"Qty")," "),r(3),l("ngIf",t.userPermissions().show_cost),r(),l("ngIf",t.userPermissions().show_cost),r(2),b(d(29,23,"Price")),r(2),l("ngIf",t.wholesaleEnabled()),r(2),x(" ",d(33,25,"\u064FTotal")," ")}}function ki(i,h){if(i&1&&(n(0,"td"),f(1),c(2,"currency"),c(3,"lira"),o()),i&2){let t=y().$implicit;r(),x(" ",t.currency=="dollar"?d(2,1,t.unit_cost_usd):d(3,3,t.unit_cost_usd)," ")}}function Ii(i,h){if(i&1&&(n(0,"td"),f(1),c(2,"currency"),c(3,"lira"),o()),i&2){let t=y().$implicit;r(),x(" ",t.currency=="dollar"?d(2,1,t.avg_cost_usd):d(3,3,t.avg_cost_usd)," ")}}function Ti(i,h){if(i&1&&(n(0,"td"),f(1),c(2,"currency"),c(3,"lira"),o()),i&2){let t=y().$implicit;r(),x(" ",(t.currency=="dollar"?d(2,1,t.wholesale_price_usd):d(3,3,t.wholesale_price_usd))||"---"," ")}}function xi(i,h){if(i&1&&(n(0,"tr",41)(1,"td"),f(2),o(),n(3,"td"),f(4),o(),n(5,"td",42),f(6),o(),n(7,"td"),f(8),o(),n(9,"td"),f(10),o(),n(11,"td"),f(12),o(),I(13,ki,4,5,"td",43)(14,Ii,4,5,"td",43),n(15,"td"),f(16),c(17,"currency"),c(18,"lira"),o(),I(19,Ti,4,5,"td",43),n(20,"td"),f(21),c(22,"currency"),c(23,"lira"),o()()),i&2){let t=h.$implicit,a=h.rowIndex,e=y();st("glowing",e.glowingRowIndex()===a),l("pSelectableRow",t),r(2),b(t.sku||"---"),r(2),b(t.barcode||"---"),r(),l("autoDir",t.product_name),r(),x(" ",t.product_name," "),r(2),b(t.category_name||"---"),r(2),b(t.brand_name||"---"),r(2),x(" ",t.stock_management?t.quantity:"--"," "),r(),l("ngIf",e.userPermissions().show_cost),r(),l("ngIf",e.userPermissions().show_cost),r(2),x(" ",t.currency=="dollar"?d(17,15,t.unit_price_usd):d(18,17,t.unit_price_usd)," "),r(3),l("ngIf",e.wholesaleEnabled()),r(2),x(" ",t.currency=="dollar"&&t.stock_management?d(22,19,t.unit_price_usd*t.quantity):d(23,21,t.unit_price_usd*t.quantity)," ")}}function Pi(i,h){i&1&&(n(0,"tr")(1,"td",44),f(2,"No items yet!"),o()())}var Nt=(()=>{class i{constructor(){this.stockService=C(M),this.confirmationService=C(A),this.authService=C(Me),this.wholesaleSettingService=C(Vt),this.translate=C(G),this.printService=C(kt),this.userPermissions=this.authService.userPermissions,this.wholesaleEnabled=this.wholesaleSettingService.wholesaleEnabled,this.inventories=this.stockService.inventories,this.loadingInventories=this.stockService.loadingInventories,this.selectedInventoryId=this.stockService.selectedInventoryId,this.rowsPerPage=this.stockService.rowsPerPage,this.products=this.stockService.products,this.productDialogVisible=!1,this.tableLoading=this.stockService.tableLoading,this.selectedProduct=this.stockService.selectedProduct,this.defaultInventory=this.stockService.defaultInventory,this.stockDialogVisible=!1,this.historyDialogVisible=this.stockService.historyDialogVisible,this.historyLoading=this.stockService.historyLoading,this.glowingRowIndex=this.stockService.glowingRowIndex,this.labelPrintDialogVisible=!1}detectMac(){return navigator.userAgent.toUpperCase().includes("MAC")}onKeyDown(t){let e=this.detectMac()?t.metaKey:t.ctrlKey,s=t.key.toLowerCase();s==="meta"||s==="control"||s==="shift"||s==="alt"||e&&["c","v","x","a","z"].includes(s)||!this.productDialogVisible&&!this.stockDialogVisible&&!this.labelPrintDialogVisible&&(this.tableSearch.nativeElement.focus(),t.key=="Enter"&&this.tableSearch.nativeElement.select())}updateRowsPerPage(t){this.stockService.updateRowsPerPage(t)}openItemDialog(t){this.dialogMode=t,this.productDialogVisible=!0}onCreateProduct(t){this.stockService.onCreateProduct(t)}onUpdateProduct(t){this.stockService.onUpdateProduct(t)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:this.translate.instant("Are you sure you want to delete selected item ?"),header:this.translate.instant("Warning"),acceptLabel:this.translate.instant("Yes"),rejectLabel:this.translate.instant("No"),icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedProduct())}})}getProducts(){this.stockService.getProducts()}refreshTable(){this.dt2.reset(),this.getProducts()}onSubmitStockCorrection(t){this.stockService.onUpdateProduct(t)}fetchHistory(){this.stockService.fetchStockHistory(this.selectedProduct().product_id)}closeHistoryDialog(){this.stockService.historyDialogVisible.set(!1)}openLabelPrint(){let t=this.selectedProduct();this.printData={barcode:t.barcode,shortName:t.product_name,price:t.unit_price_usd},this.labelPrintDialogVisible=!0}printStock(){this.printService.printStock(this.products())}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-products"]],viewQuery:function(a,e){if(a&1&&(W(_i,5),W(fi,5),W(gi,5),W(hi,5)),a&2){let s;R(s=L())&&(e.tableSearch=s.first),R(s=L())&&(e.barcodeInput=s.first),R(s=L())&&(e.itemName=s.first),R(s=L())&&(e.dt2=s.first)}},hostBindings:function(a,e){a&1&&g("keydown",function(p){return e.onKeyDown(p)},!1,rt)},decls:45,vars:65,consts:[["tableSearch",""],["dt2",""],[1,"m-2"],[1,"grid"],[1,"col-12","md:col-6","lg:col-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","search",1,"p-inputtext-sm","w-full",3,"input","placeholder","value"],["id","inventory_id","styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","optionLabel","inventory_name","optionValue","inventory_id","filterBy","inventory_name",3,"ngModelChange","autoOptionFocus","ngModel","options","placeholder","emptyMessage","filter"],[1,"col-4","lg:col-1"],["label","Print","icon","pi pi-print","size","small","severity","contrast","styleClass","w-full",3,"onClick"],["icon","pi pi-refresh","size","small","styleClass","w-full",3,"onClick","label","loading"],["icon","pi pi-plus","severity","success","size","small","styleClass","w-full",3,"onClick","label"],[1,"col-6","lg:col-1"],["size","small","severity","info","icon","pi pi-wrench","styleClass","w-full",3,"onClick","label","disabled"],["icon","pi pi-barcode","size","small","severity","help","styleClass","w-full",3,"onClick","label","disabled"],["size","small","severity","contrast","icon","pi pi-history","styleClass","w-full",3,"onClick","label","disabled","loading"],["icon","pi pi-file-edit","size","small","severity","warning","styleClass","w-full",3,"onClick","label","disabled"],["icon","pi pi-trash","styleClass","w-full","size","small","severity","danger",3,"onClick","label","disabled"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","65vh","sortMode","multiple",3,"selectionChange","rowsChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","onCreate","onUpdate","visible","product","mode"],[3,"visibleChange","onSubmit","visible","product_id","inventory_id"],[3,"onClose","visible","product_id"],[3,"visibleChange","visible","printData"],["width","7%","pSortableColumn","sku"],["field","sku"],["width","10%","pSortableColumn","barcode"],["field","barcode"],["width","26%","pSortableColumn","product_name"],["field","product_name"],["width","10%","pSortableColumn","category_name"],["field","category_name"],["width","10%","pSortableColumn","brand_name"],["field","brand_name"],["width","5%","pSortableColumn","quantity"],["field","quantity"],["width","8%",4,"ngIf"],["width","8%"],[3,"pSelectableRow"],[3,"autoDir"],[4,"ngIf"],["colspan","10"]],template:function(a,e){if(a&1){let s=P();n(0,"div",2)(1,"p-card")(2,"div",3)(3,"div",4)(4,"span",5),v(5,"i",6),n(6,"input",7,0),c(8,"translate"),g("input",function(m){u(s);let ke=N(37);return _(ke.filterGlobal(m.target.value,"contains"))}),o()()(),n(9,"div",4)(10,"p-dropdown",8),c(11,"translate"),c(12,"translate"),k("ngModelChange",function(m){return u(s),w(e.defaultInventory,m)||(e.defaultInventory=m),_(m)}),g("ngModelChange",function(){return u(s),_(e.getProducts())}),o()(),n(13,"div",9)(14,"p-button",10),g("onClick",function(){return u(s),_(e.printStock())}),o()(),n(15,"div",9)(16,"p-button",11),c(17,"translate"),g("onClick",function(){return u(s),_(e.refreshTable())}),o()(),n(18,"div",9)(19,"p-button",12),c(20,"translate"),g("onClick",function(){return u(s),_(e.openItemDialog("add"))}),o()(),n(21,"div",13)(22,"p-button",14),c(23,"translate"),g("onClick",function(){return u(s),_(e.stockDialogVisible=!0)}),o()(),n(24,"div",13)(25,"p-button",15),c(26,"translate"),g("onClick",function(){return u(s),_(e.openLabelPrint())}),o()(),n(27,"div",9)(28,"p-button",16),c(29,"translate"),g("onClick",function(){return u(s),_(e.fetchHistory())}),o()(),n(30,"div",9)(31,"p-button",17),c(32,"translate"),g("onClick",function(){return u(s),_(e.openItemDialog("edit"))}),o()(),n(33,"div",9)(34,"p-button",18),c(35,"translate"),g("onClick",function(){return u(s),_(e.deleteSelectedItem())}),o()()(),n(36,"p-table",19,1),k("selectionChange",function(m){return u(s),w(e.selectedProduct,m)||(e.selectedProduct=m),_(m)}),g("rowsChange",function(m){return u(s),_(e.updateRowsPerPage(m))}),I(38,wi,34,27,"ng-template",20)(39,xi,24,23,"ng-template",21)(40,Pi,3,0,"ng-template",22),o()()(),n(41,"product-form",23),k("visibleChange",function(m){return u(s),w(e.productDialogVisible,m)||(e.productDialogVisible=m),_(m)}),g("onCreate",function(m){return u(s),_(e.onCreateProduct(m))})("onUpdate",function(m){return u(s),_(e.onUpdateProduct(m))}),o(),n(42,"stock-correction",24),k("visibleChange",function(m){return u(s),w(e.stockDialogVisible,m)||(e.stockDialogVisible=m),_(m)}),g("onSubmit",function(m){return u(s),_(e.onSubmitStockCorrection(m))}),o(),n(43,"stock-transactions",25),g("onClose",function(){return u(s),_(e.closeHistoryDialog())}),o(),n(44,"label-print",26),k("visibleChange",function(m){return u(s),w(e.labelPrintDialogVisible,m)||(e.labelPrintDialogVisible=m),_(m)}),o()}if(a&2){let s,p,m=N(37);r(6),l("placeholder",d(8,43,"Search ..."))("value",m.filters.global==null?null:m.filters.global.value),r(4),l("autoOptionFocus",!1),S("ngModel",e.defaultInventory),l("options",e.inventories())("placeholder",d(11,45,"Select Inventory"))("emptyMessage",d(12,47,"No results found"))("filter",!0),r(6),l("label",d(17,49,"Refresh"))("loading",e.tableLoading()),r(3),l("label",d(20,51,"New")),r(3),l("label",d(23,53,"Qty"))("disabled",!e.selectedProduct()||e.selectedProduct().stock_management==0),r(3),l("label",d(26,55,"Labels"))("disabled",!e.selectedProduct()||e.selectedProduct().barcode==""),r(3),l("label",d(29,57,"History"))("disabled",!e.selectedProduct())("loading",e.historyLoading()),r(3),l("label",d(32,59,"Edit"))("disabled",!e.selectedProduct()),r(3),l("label",d(35,61,"Delete"))("disabled",!e.selectedProduct()),r(2),l("value",e.products()),S("selection",e.selectedProduct),l("paginator",!0)("rows",e.rowsPerPage())("showCurrentPageReport",!0)("rowsPerPageOptions",V(63,Ci))("alwaysShowPaginator",!0)("globalFilterFields",V(64,yi))("filterDelay",0)("loading",e.tableLoading())("scrollable",!0),r(5),S("visible",e.productDialogVisible),l("product",e.selectedProduct())("mode",e.dialogMode),r(),S("visible",e.stockDialogVisible),l("product_id",(s=e.selectedProduct())==null?null:s.product_id)("inventory_id",e.selectedInventoryId()),r(),l("visible",e.historyDialogVisible())("product_id",(p=e.selectedProduct())==null?null:p.product_id),r(),S("visible",e.labelPrintDialogVisible),l("printData",e.printData)}},dependencies:[pe,O,de,z,E,Ct,U,yt,D,ne,H,Le,Se,ye,we,be,Et,De,ze,B],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}[_nghost-%COMP%]  .p-toolbar{padding-top:.6rem!important;padding-bottom:.6rem!important}"]})}}return i})();var Wt=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-stock-home"]],decls:1,vars:0,template:function(a,e){a&1&&v(0,"router-outlet")},dependencies:[mt]})}}return i})();var Ke=(()=>{class i{constructor(){this.service=C(M),this.defaultInventory=this.service.defaultInventory,this.inventories=this.service.inventories,this.loadingInventories=this.service.loadingInventories}onOptionChange(t){this.service.setDefaultInventory(t)}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["default-inventory"]],standalone:!0,features:[Y],decls:7,vars:3,consts:[[1,"grid"],[1,"col-8","align-self-center"],[1,"m-0"],[1,"col-4"],["placeholder","Select Inventory...","styleClass","p-inputtext-sm w-full","optionLabel","inventory_name","optionValue","inventory_id","appendTo","body",3,"ngModelChange","onChange","options","ngModel","autoOptionFocus"]],template:function(a,e){a&1&&(n(0,"p-card")(1,"div",0)(2,"div",1)(3,"h3",2),f(4,"Set Default Inventory"),o()(),n(5,"div",3)(6,"p-dropdown",4),k("ngModelChange",function(p){return w(e.defaultInventory,p)||(e.defaultInventory=p),p}),g("onChange",function(p){return e.onOptionChange(p.value)}),o()()()()),a&2&&(r(6),l("options",e.inventories()),S("ngModel",e.defaultInventory),l("autoOptionFocus",!1))},dependencies:[je,Re,O,de,he,ne,Ne,Le],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}"]})}}return i})();var Ei=["rateInput"],Di=()=>({width:"35vw"}),Bi=()=>({"1199px":"85vw","575px":"95vw"});function Mi(i,h){if(i&1){let t=P();n(0,"form",8),g("ngSubmit",function(){u(t);let e=y();return _(e.submit())}),n(1,"div",9)(2,"label",10),f(3),c(4,"translate"),o(),v(5,"p-inputNumber",11,0),o()()}if(i&2){let t=y();l("formGroup",t.rateForm),r(3),b(d(4,3,"Exchange Rate")),r(2),l("min",1e3)}}function Fi(i,h){if(i&1){let t=P();n(0,"p-button",12),c(1,"translate"),g("onClick",function(){u(t);let e=y();return _(e.toggleDialog(!1))}),o(),n(2,"p-button",13),c(3,"translate"),g("onClick",function(){u(t);let e=y();return _(e.submit())}),o()}i&2&&(l("label",d(1,2,"Cancel")),r(2),l("label",d(3,4,"Save")))}var Ht=(()=>{class i{constructor(){this.rateService=C(St),this.formBuilder=C(Q),this.exchangeRate=this.rateService.exchangeRate,this.rateDialogVisible=this.rateService.rateDialogVisible,this.dialogVisible=!1,ct(()=>{this.rateForm=this.formBuilder.group({rate_value:[this.exchangeRate().rate_value]})})}toggleDialog(t){this.rateService.rateDialogVisible.set(t),setTimeout(()=>{this.rateInput&&this.rateInput.input.nativeElement.select()},50)}submit(){this.rateForm.valid&&this.rateService.updateExchangeRate(this.rateForm.value)}resetDialog(){this.rateForm.reset({rate_value:this.exchangeRate().rate_value}),this.rateService.rateDialogVisible.set(!1)}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["exchange-rate"]],viewQuery:function(a,e){if(a&1&&W(Ei,5),a&2){let s;R(s=L())&&(e.rateInput=s.first)}},decls:15,vars:19,consts:[["rateInput",""],[1,"p-toolbar-group-start"],[1,"text-green-600"],[1,"p-toolbar-group-end"],["icon","pi pi-file-edit","styleClass","p-button-warning",3,"onClick","label"],["styleClass","p-fluid",3,"visibleChange","onHide","visible","header","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["formControlName","rate_value",3,"min"],["icon","pi pi-times","severity","secondary","size","small",3,"onClick","label"],["icon","pi pi-check","severity","success","size","small",3,"onClick","label"]],template:function(a,e){a&1&&(n(0,"p-toolbar")(1,"div",1)(2,"h3"),f(3),c(4,"translate"),n(5,"span",2),f(6),c(7,"lira"),o()()(),n(8,"div",3)(9,"p-button",4),c(10,"translate"),g("onClick",function(){return e.toggleDialog(!0)}),o()()(),n(11,"p-dialog",5),c(12,"translate"),k("visibleChange",function(p){return w(e.rateDialogVisible,p)||(e.rateDialogVisible=p),p}),g("onHide",function(){return e.resetDialog()}),I(13,Mi,7,5,"ng-template",6)(14,Fi,4,6,"ng-template",7),o()),a&2&&(r(3),x(" ",d(4,9,"Dollar Exchange:")," "),r(3),b(d(7,11,e.exchangeRate().rate_value)),r(3),l("label",d(10,13,"Edit")),r(2),Z(V(17,Di)),S("visible",e.rateDialogVisible),l("header",d(12,15,"Exchange Rate"))("modal",!0)("breakpoints",V(18,Bi)))},dependencies:[me,O,ce,ue,_e,E,Ce,D,te,We,ze,B]})}}return i})();var Li=()=>({width:"35vw"}),Ni=()=>({"1199px":"75vw","575px":"85vw"}),Wi=i=>({"ng-invalid ng-dirty":i});function Oi(i,h){if(i&1){let t=P();n(0,"form",3),g("ngSubmit",function(){u(t);let e=y();return _(e.submitInventory())}),n(1,"div",4)(2,"label",5),f(3),c(4,"translate"),o(),v(5,"input",6),o()()}if(i&2){let t=y();l("formGroup",t.inventoryForm),r(3),b(d(4,3,"Inventory Name")),r(2),l("ngClass",ae(5,Wi,t.f.inventory_name.invalid&&(t.f.inventory_name.dirty||t.f.inventory_name.touched)))}}function Hi(i,h){if(i&1){let t=P();n(0,"p-button",7),c(1,"translate"),g("onClick",function(){u(t);let e=y();return _(e.closeInventoryDialog())}),o(),n(2,"p-button",8),c(3,"translate"),g("onClick",function(){u(t);let e=y();return _(e.submitInventory())}),o()}if(i&2){let t=y();l("label",d(1,3,"Cancel")),r(2),l("label",d(3,5,"Save"))("loading",t.submitLoading)}}var Ze=(()=>{class i{constructor(){this.fb=C(Q),this.api=C(Be),this.notification=C(X),this.visible=!1,this.inventory=null,this.visibleChange=new K,this.onCreate=new K,this.onUpdate=new K,this.submitLoading=!1,this.submitted=!1,this.inventoryForm=this.fb.group({inventory_id:[null],inventory_name:[null,q.required]})}ngOnChanges(t){t.visible&&this.visible&&(this.mode=="edit"?this.inventoryForm.patchValue(this.inventory):this.inventoryForm.reset())}get f(){return this.inventoryForm.controls}closeInventoryDialog(){this.submitted=!1,this.visibleChange.emit(!1)}submitInventory(){if(this.submitted=!0,this.inventoryForm.valid){this.submitLoading=!0;let t=this.inventoryForm.getRawValue();(this.mode=="add"?this.api.post("inventory",t):this.api.put("inventory",t)).pipe(Ve(()=>{this.submitLoading=!1})).subscribe({next:e=>{this.mode=="add"?this.onCreate.emit(e):this.onUpdate.emit(e),this.closeInventoryDialog(),this.notification.showSuccess()}})}}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["inventory-form"]],inputs:{visible:"visible",mode:"mode",inventory:"inventory"},outputs:{visibleChange:"visibleChange",onCreate:"onCreate",onUpdate:"onUpdate"},standalone:!0,features:[Ee,Y],decls:4,vars:10,consts:[["styleClass","p-fluid",3,"visibleChange","onHide","visible","header","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["type","text","pInputText","","formControlName","inventory_name","spellcheck","false",3,"ngClass"],["icon","pi pi-times","severity","secondary","size","small",3,"onClick","label"],["icon","pi pi-check","severity","success","size","small",3,"onClick","label","loading"]],template:function(a,e){a&1&&(n(0,"p-dialog",0),c(1,"translate"),k("visibleChange",function(p){return w(e.visible,p)||(e.visible=p),p}),g("onHide",function(){return e.closeInventoryDialog()}),I(2,Oi,6,7,"ng-template",1)(3,Hi,4,7,"ng-template",2),o()),a&2&&(Z(V(8,Li)),S("visible",e.visible),l("header",d(1,6,"Inventory"))("modal",!0)("breakpoints",V(9,Ni)))},dependencies:[j,J,ie,te,E,$,D,ge,H,B,fe,me,Fe,O,ce,ue,_e,Ue]})}}return i})();var Ui=()=>[10,15,50,100],ji=()=>["inventory_name"];function Ai(i,h){if(i&1){let t=P();n(0,"span",11),v(1,"i",12),n(2,"input",13,1),c(4,"translate"),g("input",function(e){u(t),y();let s=N(5);return _(s.filterGlobal(e.target.value,"contains"))}),o()(),n(5,"p-button",14),c(6,"translate"),g("onClick",function(){u(t);let e=y();return _(e.refreshInventories())}),o(),n(7,"p-button",15),c(8,"translate"),g("onClick",function(){u(t);let e=y();return _(e.openInventoryDialog("add"))}),o()}if(i&2){let t=y(),a=N(5);r(2),l("placeholder",d(4,5,"Search ..."))("value",a.filters.global==null?null:a.filters.global.value),r(3),l("label",d(6,7,"Refresh"))("loading",t.loadingInventories()),r(2),l("label",d(8,9,"New Inventory"))}}function qi(i,h){if(i&1){let t=P();n(0,"p-button",16),c(1,"translate"),g("onClick",function(){u(t);let e=y();return _(e.openInventoryDialog("edit"))}),o(),n(2,"p-button",17),c(3,"translate"),g("onClick",function(){u(t);let e=y();return _(e.deleteSelectedInventory())}),o()}if(i&2){let t=y();l("label",d(1,4,"Edit"))("disabled",!t.selectedInventory()),r(2),l("label",d(3,6,"Delete"))("disabled",!t.selectedInventory())}}function Qi(i,h){i&1&&(n(0,"tr")(1,"th"),f(2),c(3,"translate"),o()()),i&2&&(r(2),b(d(3,1,"Name")))}function Gi(i,h){if(i&1&&(n(0,"tr",18)(1,"td"),f(2),o()()),i&2){let t=h.$implicit;l("pSelectableRow",t),r(2),b(t.inventory_name)}}function Ki(i,h){i&1&&(n(0,"tr")(1,"td",19),f(2,"No Inventories yet!"),o()())}var zt=(()=>{class i{constructor(){this.stockService=C(M),this.confirmationService=C(A),this.notificationService=C(X),this.translate=C(G),this.fb=C(Q),this.inventoryDialogVisible=!1,this.inventories=this.stockService.inventories,this.loadingInventories=this.stockService.loadingInventories,this.selectedInventory=at(null),this.inventoryForm=this.fb.group({inventory_id:[null],inventory_name:[null,q.required]})}refreshInventories(){this.stockService.getInventories()}get f(){return this.inventoryForm.controls}openInventoryDialog(t){this.dialogMode=t,this.inventoryDialogVisible=!0}onCreateInventory(t){this.inventories.set([...this.inventories(),t])}onUpdateInventory(t){let a=this.inventories().findIndex(e=>e.inventory_id===t.inventory_id);this.inventories.update(e=>[...e.slice(0,a),t,...e.slice(a+1)]),this.selectedInventory.set(t)}deleteSelectedInventory(){}resetDialog(){this.inventoryForm.reset()}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["inventories"]],decls:10,vars:16,consts:[["ct",""],["tableSearch",""],["header","Inventories"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["selectionMode","single","dataKey","inventory_id","styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","55vh",3,"selectionChange","value","selection","loading","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","scrollable","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","onCreate","onUpdate","visible","inventory","mode"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","search",1,"p-inputtext-sm",3,"input","placeholder","value"],["icon","pi pi-refresh","size","small","styleClass","mx-2",3,"onClick","label","loading"],["icon","pi pi-plus","severity","success","size","small",3,"onClick","label"],["icon","pi pi-file-edit","severity","warning","size","small",1,"mr-2",3,"onClick","label","disabled"],["icon","pi pi-trash","severity","danger","size","small",3,"onClick","label","disabled"],[3,"pSelectableRow"],["colspan","3"]],template:function(a,e){if(a&1){let s=P();n(0,"p-panel",2)(1,"p-toolbar",3),I(2,Ai,9,11,"ng-template",4)(3,qi,4,8,"ng-template",5),o(),n(4,"p-table",6,0),k("selectionChange",function(m){return u(s),w(e.selectedInventory,m)||(e.selectedInventory=m),_(m)}),I(6,Qi,4,3,"ng-template",7)(7,Gi,3,2,"ng-template",8)(8,Ki,3,0,"ng-template",9),o()(),n(9,"inventory-form",10),k("visibleChange",function(m){return u(s),w(e.inventoryDialogVisible,m)||(e.inventoryDialogVisible=m),_(m)}),g("onCreate",function(m){return u(s),_(e.onCreateInventory(m))})("onUpdate",function(m){return u(s),_(e.onUpdateInventory(m))}),o()}a&2&&(r(4),l("value",e.inventories()),S("selection",e.selectedInventory),l("loading",e.loadingInventories())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",V(14,Ui))("alwaysShowPaginator",!0)("scrollable",!0)("globalFilterFields",V(15,ji))("filterDelay",0),r(5),S("visible",e.inventoryDialogVisible),l("inventory",e.selectedInventory())("mode",e.dialogMode))},dependencies:[z,E,U,Ce,D,H,ee,Ze,B]})}}return i})();var Ut=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["stock-settings"]],decls:9,vars:0,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"]],template:function(a,e){a&1&&(n(0,"div",0)(1,"div",1),v(2,"exchange-rate")(3,"br")(4,"default-inventory")(5,"br")(6,"inventories"),o(),n(7,"div",1),v(8,"stock-value"),o()())},dependencies:[Qe,Ke,Ht,zt]})}}return i})();var Yi=()=>[10,15,50,100],Ji=()=>["category_name"],Xi=(i,h)=>({" pi-check-circle text-green-600":i,"pi-times-circle text-red-600":h});function $i(i,h){i&1&&(n(0,"tr")(1,"th",20),f(2),c(3,"translate"),o(),n(4,"th",21),f(5),c(6,"translate"),o(),n(7,"th",22),f(8),c(9,"translate"),o()()),i&2&&(r(2),b(d(3,3,"Sort")),r(3),b(d(6,5,"Name")),r(3),b(d(9,7,"Visible")))}function en(i,h){if(i&1&&(n(0,"tr",23)(1,"td"),v(2,"span",24),o(),n(3,"td"),f(4),o(),n(5,"td"),v(6,"i",25),o()()),i&2){let t=h.$implicit,a=h.rowIndex;l("pReorderableRow",a)("pSelectableRow",t),r(4),b(t.category_name),r(2),l("ngClass",Ie(4,Xi,t.show_on_sell,!t.show_on_sell))}}function tn(i,h){i&1&&(n(0,"tr")(1,"td",26),f(2,"No Categories yet!"),o()())}var jt=(()=>{class i{constructor(){this.stockService=C(M),this.confirmationService=C(A),this.notificationService=C(X),this.translate=C(G),this.categoryDialogVisible=!1,this.categories=this.stockService.categories,this.categoriesLoading=this.stockService.categoriesLoading,this.selectedCategory=this.stockService.selectedCategory}sortCategories(){this.stockService.sortCategories()}selectCategory(){this.stockService.selectedCategoryProduct.set(null)}refreshCategories(){this.stockService.getCategories()}openCategoryDialog(t){this.dialogMode=t,this.categoryDialogVisible=!0}onCreateCategory(t){this.categories.set([...this.categories(),t])}onUpdateCategory(t){let a=this.categories().findIndex(e=>e.category_id===t.category_id);this.categories.update(e=>[...e.slice(0,a),t,...e.slice(a+1)])}deleteSelectedCategory(){this.confirmationService.confirm({key:"home",message:this.translate.instant("Are you sure you want to delete selected category ?"),header:this.translate.instant("Warning"),acceptLabel:this.translate.instant("Yes"),rejectLabel:this.translate.instant("No"),icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteCategory(this.selectedCategory().category_id)}})}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["categories"]],decls:26,vars:35,consts:[["tableSearch",""],["ct",""],["header","Categories"],[1,"grid"],[1,"col-6","md:col-3"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","search",1,"p-inputtext-sm","w-full",3,"input","placeholder","value"],[1,"col-6","md:col-3","lg:col-2"],["icon","pi pi-refresh","size","small","styleClass","w-full",3,"onClick","label","loading"],[1,"col-6","md:col-3","lg:col-3"],["icon","pi pi-plus","severity","success","size","small","styleClass","w-full",3,"onClick","label"],[1,"col-3","md:col-3","lg:col-2"],["icon","pi pi-file-edit","severity","warning","size","small","styleClass","w-full",1,"mr-2",3,"onClick","label","disabled"],["icon","pi pi-trash","severity","danger","size","small","styleClass","w-full",3,"onClick","label","disabled"],["selectionMode","single","dataKey","category_id","styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","55vh",3,"selectionChange","onRowReorder","onRowSelect","value","selection","loading","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","scrollable","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","onCreate","onUpdate","visible","category","mode"],["width","10%"],["width","75%"],["width","15%"],[3,"pReorderableRow","pSelectableRow"],["pReorderableRowHandle","",1,"pi","pi-bars"],[1,"pi",3,"ngClass"],["colspan","3"]],template:function(a,e){if(a&1){let s=P();n(0,"p-panel",2)(1,"div",3)(2,"div",4)(3,"span",5),v(4,"i",6),n(5,"input",7,0),c(7,"translate"),g("input",function(m){u(s);let ke=N(21);return _(ke.filterGlobal(m.target.value,"contains"))}),o()()(),n(8,"div",8)(9,"p-button",9),c(10,"translate"),g("onClick",function(){return u(s),_(e.refreshCategories())}),o()(),n(11,"div",10)(12,"p-button",11),c(13,"translate"),g("onClick",function(){return u(s),_(e.openCategoryDialog("add"))}),o()(),n(14,"div",12)(15,"p-button",13),c(16,"translate"),g("onClick",function(){return u(s),_(e.openCategoryDialog("edit"))}),o()(),n(17,"div",12)(18,"p-button",14),c(19,"translate"),g("onClick",function(){return u(s),_(e.deleteSelectedCategory())}),o()()(),n(20,"p-table",15,1),k("selectionChange",function(m){return u(s),w(e.selectedCategory,m)||(e.selectedCategory=m),_(m)}),g("onRowReorder",function(){return u(s),_(e.sortCategories())})("onRowSelect",function(){return u(s),_(e.selectCategory())}),I(22,$i,10,9,"ng-template",16)(23,en,7,7,"ng-template",17)(24,tn,3,0,"ng-template",18),o()(),n(25,"category-form",19),k("visibleChange",function(m){return u(s),w(e.categoryDialogVisible,m)||(e.categoryDialogVisible=m),_(m)}),g("onCreate",function(m){return u(s),_(e.onCreateCategory(m))})("onUpdate",function(m){return u(s),_(e.onUpdateCategory(m))}),o()}if(a&2){let s=N(21);r(5),l("placeholder",d(7,23,"Search ..."))("value",s.filters.global==null?null:s.filters.global.value),r(4),l("label",d(10,25,"Refresh"))("loading",e.categoriesLoading()),r(3),l("label",d(13,27,"New Category")),r(3),l("label",d(16,29,"Edit"))("disabled",!e.selectedCategory()),r(3),l("label",d(19,31,"Delete"))("disabled",!e.selectedCategory()),r(2),l("value",e.categories()),S("selection",e.selectedCategory),l("loading",e.categoriesLoading())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",V(33,Yi))("alwaysShowPaginator",!0)("scrollable",!0)("globalFilterFields",V(34,Ji))("filterDelay",0),r(5),S("visible",e.categoryDialogVisible),l("category",e.selectedCategory())("mode",e.dialogMode)}},dependencies:[J,z,E,U,bt,vt,D,H,ee,Ae,B]})}}return i})();var on=["barcodeInput"],rn=["itemName"],an=["tableSearch"],sn=["dt"],ln=()=>[10,25,50],pn=()=>["product_name","barcode","sku"];function cn(i,h){i&1&&(n(0,"th",28),f(1),c(2,"translate"),o()),i&2&&(r(),x(" ",d(2,1,"Cost")," "))}function dn(i,h){if(i&1&&(n(0,"tr")(1,"th",24),f(2),c(3,"translate"),o(),n(4,"th",25),f(5),c(6,"translate"),o(),n(7,"th",26),f(8),c(9,"translate"),o(),I(10,cn,3,3,"th",27),n(11,"th",28),f(12),c(13,"translate"),o()()),i&2){let t=y();r(2),b(d(3,5,"Barcode")),r(3),b(d(6,7,"Name")),r(3),b(d(9,9,"Qty")),r(2),l("ngIf",t.userPermissions().show_cost),r(2),b(d(13,11,"Price"))}}function mn(i,h){if(i&1&&(n(0,"td"),f(1),c(2,"currency"),o()),i&2){let t=y().$implicit;r(),x(" ",d(2,1,t.unit_cost_usd)," ")}}function un(i,h){if(i&1&&(n(0,"tr",29)(1,"td"),f(2),o(),n(3,"td"),f(4),o(),n(5,"td"),f(6),o(),I(7,mn,3,3,"td",30),n(8,"td"),f(9),c(10,"currency"),o()()),i&2){let t=h.$implicit,a=y();l("pSelectableRow",t),r(2),b(t.barcode||" --- "),r(2),b(t.product_name),r(2),x(" ",t.stock_management?t.quantity:"--"," "),r(),l("ngIf",a.userPermissions().show_cost),r(2),b(d(10,6,t.unit_price_usd))}}function _n(i,h){i&1&&(n(0,"tr")(1,"td",31),f(2),c(3,"translate"),o()()),i&2&&(r(2),b(d(3,1,"No items yet!")))}var At=(()=>{class i{constructor(){this.stockService=C(M),this.authService=C(Me),this.fb=C(Q),this.confirmationService=C(A),this.translate=C(G),this.userPermissions=this.authService.userPermissions,this.selectedCategory=this.stockService.selectedCategory,this.products=this.stockService.products,this.inventories=this.stockService.inventories,this.loadingInventories=this.stockService.loadingInventories,this.selectedInventoryId=this.stockService.selectedInventoryId,this.filteredProducts=pt(()=>{let t=this.products(),a=this.selectedCategory();return a?t.filter(e=>e.category_id_fk===a.category_id):t}),this.tableLoading=this.stockService.tableLoading,this.selectedCategoryProduct=this.stockService.selectedCategoryProduct,this.sellProductsLoading=this.stockService.sellProductsLoading,this.productDialogVisible=!1,this.stockDialogVisible=!1,this.historyDialogVisible=this.stockService.historyDialogVisible,this.historyLoading=this.stockService.historyLoading,this.labelPrintDialogVisible=!1}openProductDialog(t){this.dialogMode=t,this.productDialogVisible=!0}onCreateProduct(t){this.stockService.onCreateProduct(t)}onUpdateProduct(t){this.stockService.onUpdateProduct(t)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:this.translate.instant("Are you sure you want to delete selected item ?"),header:this.translate.instant("Warning"),acceptLabel:this.translate.instant("Yes"),rejectLabel:this.translate.instant("No"),icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedCategoryProduct())}})}onSubmitStockCorrection(t){this.stockService.onUpdateProduct(t)}fetchHistory(){this.stockService.fetchStockHistory(this.selectedCategoryProduct().product_id)}closeHistoryDialog(){this.stockService.historyDialogVisible.set(!1)}openLabelPrint(){let t=this.selectedCategoryProduct();this.printData={barcode:t.barcode,shortName:t.product_name,price:t.unit_price_usd},this.labelPrintDialogVisible=!0}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["category-items"]],viewQuery:function(a,e){if(a&1&&(W(on,5),W(rn,5),W(an,5),W(sn,5)),a&2){let s;R(s=L())&&(e.barcodeInput=s.first),R(s=L())&&(e.itemName=s.first),R(s=L())&&(e.tableSearch=s.first),R(s=L())&&(e.dt=s.first)}},decls:34,vars:45,consts:[["tableSearch",""],["dt",""],[3,"header"],[1,"grid"],[1,"col-6","md:col-3"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","search",1,"p-inputtext-sm","w-full",3,"input","placeholder","value"],["id","inventory_id","styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","optionLabel","inventory_name","optionValue","inventory_id","filterBy","inventory_name",3,"ngModelChange","autoOptionFocus","ngModel","options","placeholder","emptyMessage","filter"],[1,"col-2","md:col-2","lg:col-1"],["icon","pi pi-plus","styleClass","w-full","size","small","severity","success","pTooltip","New Product","tooltipPosition","top",3,"onClick"],["size","small","styleClass","w-full","severity","info","icon","pi pi-wrench","pTooltip","Correct Stock","tooltipPosition","top",3,"onClick","disabled"],["size","small","severity","contrast","icon","pi pi-history","styleClass","w-full","pTooltip","Transaction History","tooltipPosition","top",3,"onClick","disabled","loading"],["icon","pi pi-barcode","size","small","severity","help","styleClass","w-full","pTooltip","Label Print","tooltipPosition","top",3,"onClick","disabled"],["icon","pi pi-file-edit","styleClass","w-full","size","small","severity","warning","pTooltip","Edit","tooltipPosition","top",3,"onClick","disabled"],["icon","pi pi-trash","styleClass","w-full","size","small","severity","danger","pTooltip","Delete","tooltipPosition","top",3,"onClick","disabled"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","onCreate","onUpdate","visible","product","mode","selectedCategory"],[3,"visibleChange","onSubmit","visible","product_id"],[3,"onClose","visible","product_id"],[3,"visibleChange","visible","printData"],["width","20%"],["width","40%"],["width","10%"],["width","15%",4,"ngIf"],["width","15%"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","5"]],template:function(a,e){if(a&1){let s=P();n(0,"p-panel",2),c(1,"titlecase"),n(2,"div",3)(3,"div",4)(4,"span",5),v(5,"i",6),n(6,"input",7,0),c(8,"translate"),g("input",function(m){u(s);let ke=N(26);return _(ke.filterGlobal(m.target.value,"contains"))}),o()()(),n(9,"div",4)(10,"p-dropdown",8),c(11,"translate"),c(12,"translate"),k("ngModelChange",function(m){return u(s),w(e.selectedInventoryId,m)||(e.selectedInventoryId=m),_(m)}),g("ngModelChange",function(){return u(s),_(e.stockService.getProducts())}),o()(),n(13,"div",9)(14,"p-button",10),g("onClick",function(){return u(s),_(e.openProductDialog("add"))}),o()(),n(15,"div",9)(16,"p-button",11),g("onClick",function(){return u(s),_(e.stockDialogVisible=!0)}),o()(),n(17,"div",9)(18,"p-button",12),g("onClick",function(){return u(s),_(e.fetchHistory())}),o()(),n(19,"div",9)(20,"p-button",13),g("onClick",function(){return u(s),_(e.openLabelPrint())}),o()(),n(21,"div",9)(22,"p-button",14),g("onClick",function(){return u(s),_(e.openProductDialog("edit"))}),o()(),n(23,"div",9)(24,"p-button",15),g("onClick",function(){return u(s),_(e.deleteSelectedItem())}),o()()(),n(25,"p-table",16,1),k("selectionChange",function(m){return u(s),w(e.selectedCategoryProduct,m)||(e.selectedCategoryProduct=m),_(m)}),I(27,dn,14,13,"ng-template",17)(28,un,11,8,"ng-template",18)(29,_n,4,3,"ng-template",19),o()(),n(30,"product-form",20),k("visibleChange",function(m){return u(s),w(e.productDialogVisible,m)||(e.productDialogVisible=m),_(m)}),g("onCreate",function(m){return u(s),_(e.onCreateProduct(m))})("onUpdate",function(m){return u(s),_(e.onUpdateProduct(m))}),o(),n(31,"stock-correction",21),k("visibleChange",function(m){return u(s),w(e.stockDialogVisible,m)||(e.stockDialogVisible=m),_(m)}),g("onSubmit",function(m){return u(s),_(e.onSubmitStockCorrection(m))}),o(),n(32,"stock-transactions",22),g("onClose",function(){return u(s),_(e.closeHistoryDialog())}),o(),n(33,"label-print",23),k("visibleChange",function(m){return u(s),w(e.labelPrintDialogVisible,m)||(e.labelPrintDialogVisible=m),_(m)}),o()}if(a&2){let s,p,m=N(26);lt("header",d(1,35,e.selectedCategory().category_name)),r(6),l("placeholder",d(8,37,"Search ..."))("value",m.filters.global==null?null:m.filters.global.value),r(4),l("autoOptionFocus",!1),S("ngModel",e.selectedInventoryId),l("options",e.inventories())("placeholder",d(11,39,"Select Inventory"))("emptyMessage",d(12,41,"No results found"))("filter",!0),r(6),l("disabled",!e.selectedCategoryProduct()||!e.selectedCategoryProduct().stock_management),r(2),l("disabled",!e.selectedCategoryProduct())("loading",e.historyLoading()),r(2),l("disabled",!e.selectedCategoryProduct()||e.selectedCategoryProduct().barcode==""),r(2),l("disabled",!e.selectedCategoryProduct()),r(2),l("disabled",!e.selectedCategoryProduct()),r(),l("value",e.filteredProducts()),S("selection",e.selectedCategoryProduct),l("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",V(43,ln))("alwaysShowPaginator",!1)("globalFilterFields",V(44,pn))("filterDelay",0)("loading",e.sellProductsLoading()),r(5),S("visible",e.productDialogVisible),l("product",e.selectedCategoryProduct())("mode",e.dialogMode)("selectedCategory",e.selectedCategory()),r(),S("visible",e.stockDialogVisible),l("product_id",(s=e.selectedCategoryProduct())==null?null:s.product_id),r(),l("visible",e.historyDialogVisible())("product_id",(p=e.selectedCategoryProduct())==null?null:p.product_id),r(),S("visible",e.labelPrintDialogVisible),l("printData",e.printData)}},dependencies:[pe,O,de,z,E,U,D,ne,H,ee,Se,ye,we,be,gt,dt,De,B]})}}return i})();function gn(i,h){i&1&&v(0,"category-items")}var qt=(()=>{class i{constructor(){this.stockService=C(M),this.selectedCategory=this.stockService.selectedCategory}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-categories-home"]],decls:5,vars:1,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"],[4,"ngIf"]],template:function(a,e){a&1&&(n(0,"div",0)(1,"div",1),v(2,"categories"),o(),n(3,"div",1),I(4,gn,1,0,"category-items",2),o()()),a&2&&(r(4),l("ngIf",e.selectedCategory()))},dependencies:[pe,jt,At]})}}return i})();function hn(i,h){if(i&1){let t=P();n(0,"p-button",9),g("onClick",function(){u(t);let e=y();return _(e.openBrandDialog("add"))}),o()}}function Cn(i,h){if(i&1){let t=P();n(0,"p-button",10),g("onClick",function(){u(t);let e=y();return _(e.openBrandDialog("edit"))}),o(),n(1,"p-button",11),g("onClick",function(){u(t);let e=y();return _(e.deleteSelectedBrand())}),o()}if(i&2){let t=y();l("disabled",!t.selectedBrand()),r(),l("disabled",!t.selectedBrand())}}function yn(i,h){i&1&&(n(0,"tr")(1,"th"),f(2,"Brand Name"),o()())}function bn(i,h){if(i&1&&(n(0,"tr",12)(1,"td"),f(2),o()()),i&2){let t=h.$implicit;l("pSelectableRow",t),r(2),b(t.brand_name)}}function vn(i,h){i&1&&(n(0,"tr")(1,"td"),f(2,"No Brands yet!"),o()())}var Qt=(()=>{class i{constructor(){this.stockService=C(M),this.confirmationService=C(A),this.brands=this.stockService.brands,this.brandsLoading=this.stockService.brandsLoading,this.selectedBrand=this.stockService.selectedBrand,this.brandDialogVisible=!1}openBrandDialog(t){this.dialogMode=t,this.brandDialogVisible=!0}onCreateBrand(t){this.brands.set([...this.brands(),t])}onUpdateBrand(t){let a=this.brands().findIndex(e=>e.brand_id===t.brand_id);this.brands.update(e=>[...e.slice(0,a),t,...e.slice(a+1)]),this.selectedBrand.set(t)}deleteSelectedBrand(){this.confirmationService.confirm({key:"home",message:`Are you sure that you want to delete "${this.selectedBrand()?.brand_name}"?`,header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteBrand(this.selectedBrand().brand_id)}})}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["stock-brands"]],decls:9,vars:6,consts:[["header","Brands"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["selectionMode","single","dataKey","brand_id","styleClass","p-datatable-sm",3,"selectionChange","value","selection","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","onCreate","onUpdate","visible","brand","mode"],["label","New Brand","icon","pi pi-plus","severity","success","size","small",3,"onClick"],["label","Edit","icon","pi pi-file-edit","styleClass","mr-2","severity","warning","size","small",3,"onClick","disabled"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",3,"onClick","disabled"],[3,"pSelectableRow"]],template:function(a,e){a&1&&(n(0,"p-panel",0)(1,"p-toolbar",1),I(2,hn,1,0,"ng-template",2)(3,Cn,2,2,"ng-template",3),o(),n(4,"p-table",4),k("selectionChange",function(p){return w(e.selectedBrand,p)||(e.selectedBrand=p),p}),I(5,yn,3,0,"ng-template",5)(6,bn,3,2,"ng-template",6)(7,vn,3,0,"ng-template",7),o()(),n(8,"brand-form",8),k("visibleChange",function(p){return w(e.brandDialogVisible,p)||(e.brandDialogVisible=p),p}),g("onCreate",function(p){return e.onCreateBrand(p)})("onUpdate",function(p){return e.onUpdateBrand(p)}),o()),a&2&&(r(4),l("value",e.brands()),S("selection",e.selectedBrand),l("loading",e.brandsLoading()),r(4),S("visible",e.brandDialogVisible),l("brand",e.selectedBrand())("mode",e.dialogMode))},dependencies:[z,E,U,Ce,D,ee,qe]})}}return i})();var Gt=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-brands-home"]],decls:3,vars:0,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"]],template:function(a,e){a&1&&(n(0,"div",0)(1,"div",1),v(2,"stock-brands"),o()())},dependencies:[Qt]})}}return i})();var wn=[{path:"",component:Wt,children:[{path:"products",data:{breadcrumb:"Products"},component:Nt},{path:"categories",data:{breadcrumb:"Categories"},component:qt},{path:"brands",data:{breadcrumb:"Brands"},component:Gt},{path:"settings",data:{breadcrumb:"Settings"},component:Ut},{path:"**",redirectTo:"/stock/items"}]}],Kt=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=le({type:i})}static{this.\u0275inj=se({imports:[Ye.forChild(wn),Ye]})}}return i})();var Jr=et([$e({transform:"{{transform}}",opacity:0}),Xe("{{transition}}")]),Xr=et([Xe("{{transition}}",$e({transform:"{{transform}}",opacity:0}))]);var Zt=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=le({type:i});static \u0275inj=se({imports:[j,ut,Je,ft,Je]})}return i})();var ns=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=le({type:i})}static{this.\u0275inj=se({imports:[j,Re,fe,Kt,He,je,$,ie,he,ge,Oe,Ne,It,Zt,_t,Ue,Tt,xt,Se,Pt,Qe,Mt,Ft,ye,we,be,Ae,qe,Ke,Ze,ht]})}}return i})();export{ns as StockModule};
