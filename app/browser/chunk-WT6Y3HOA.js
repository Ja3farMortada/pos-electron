import{a as l}from"./chunk-4PLGKOLD.js";import{b as f}from"./chunk-AFTSMEUE.js";import{b as h}from"./chunk-4A2WLUYH.js";import{C as t,Vb as o,Wb as n,da as r,pb as c,y as a}from"./chunk-DSVZHE42.js";var k=(()=>{class s{constructor(){this.http=t(c),this.api=t(n),this.notificationService=t(o),this.socket=t(l),this.userService=t(h),this.currencyService=t(f),this.loading_balance=r(!1),this.balance=r({}),this.defaultCurrency=this.currencyService.defaultCurrency,this.selectedCurrency=r(this.defaultCurrency()),this.cashDialogVisible=r(!1),this.socketId=this.userService.socketId,this.getBalance(),this.initializeSockets()}getBalance(){this.loading_balance.set(!0),this.http.get(`${this.api.host()}/balance/${this.selectedCurrency()}`).subscribe({next:e=>{this.balance.set(e),this.loading_balance.set(!1)},error:e=>{console.log(e),this.loading_balance.set(!1)}})}submitCash(e){this.http.post(`${this.api.host()}/balance/correct`,e).subscribe({next:i=>{this.notificationService.showSuccess(i.message,"home"),this.cashDialogVisible.set(!1),this.getBalance()},error:i=>{this.notificationService.handleError(i.error,"home")}})}initializeSockets(){this.socket.on("cashBalanceUpdated",e=>{e.user_id!=this.socketId()&&(this.getBalance(),this.notificationService.showSocketMessage("Cash balance have been updated manually!","home"))})}static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{k as a};
