import{C as h,Vb as l,Wb as d,c as a,da as t,pb as u,y as c}from"./chunk-DSVZHE42.js";var v=(()=>{class i{constructor(){this.http=h(u),this.api=h(d),this.notificationService=h(l),this.host=this.api.host,this.userDialogVisible=t(!1),this.users=t([]),this.usersLoading=t(!1),this.loading=t(!1),this.selectedUser=t(null),this.existedUsernameError=new a,this.getUsers()}getUsers(){this.usersLoading.set(!0),this.http.get(`${this.host()}/users`).subscribe({next:e=>{this.users.set(e),this.usersLoading.set(!1)},error:e=>{this.usersLoading.set(!1),this.notificationService.handleError(e.error,"home")}})}createUser(e){this.usersLoading.set(!0),this.http.post(`${this.host()}/users`,e).subscribe({next:s=>{this.users.set([...this.users(),s]),this.loading.set(!1),this.usersLoading.set(!1),this.userDialogVisible.set(!1),this.notificationService.showSuccess("User added successfully!","home")},error:s=>{s.status==406?(this.loading.set(!1),this.existedUsernameError.next()):this.notificationService.handleError(s.error,"home"),this.usersLoading.set(!1)}})}updateUser(e){this.http.put(`${this.host()}/users`,e).subscribe({next:s=>{this.users.update(r=>{let o=this.users().findIndex(n=>n.user_id===e.user_id);return[...r.slice(0,o),s,...r.slice(o+1)]}),this.userDialogVisible.set(!1),this.selectedUser.set(e),this.loading.set(!1),this.notificationService.showSuccess("User updated successfully!","home")},error:s=>{s.status==406?this.existedUsernameError.next():this.notificationService.handleError(s.error,"home"),this.loading.set(!1)}})}deleteUser(e){this.http.delete(`${this.host()}/users/${e.user_id}`).subscribe({next:s=>{this.users.update(r=>{let o=this.users().findIndex(n=>n.user_id===e.user_id);return r.splice(o,1),[...r]}),this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home")}})}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{v as a};
