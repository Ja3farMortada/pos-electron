import{a as ye,b as Ue}from"./chunk-WVQGEQLH.js";import{a as Ce,b as xe}from"./chunk-VL5A4WUO.js";import"./chunk-TQK45RMZ.js";import{a as Se}from"./chunk-ARZ4TFMZ.js";import{a as be}from"./chunk-DZEX3CJ6.js";import"./chunk-KICUZIBO.js";import{a as ve,b as we}from"./chunk-42BTCZ3Y.js";import{a as he,b as ge}from"./chunk-7QYRFDGN.js";import{F as fe,j as de,m as ce,u as ue,x as _e}from"./chunk-LBGQA5HW.js";import{b as le,c as ae}from"./chunk-VVKQAEX7.js";import{Ba as R,C as U,Ca as P,D as N,Da as j,E as T,Ea as k,Eb as B,Fa as l,Ga as a,Ja as q,Jb as I,K as f,Ka as L,L as h,La as A,Oa as S,Pa as V,Qc as pe,Rc as me,Sb as W,Xa as o,Y as r,Ya as s,Yb as Q,_b as b,a as D,ac as Y,bc as K,ga as w,gb as z,gc as J,hc as X,ia as u,ib as G,ic as Z,jc as $,kc as ee,la as H,lc as te,mc as ie,na as C,nb as O,oa as n,pa as i,qa as m,ua as x,va as g,wa as _,wc as ne,xc as re,yc as oe,z as E,zc as se}from"./chunk-DSVZHE42.js";import"./chunk-GAL4ENT6.js";var Fe=["name"],He=()=>[10,15,50,100],ke=()=>["username","first_name","last_name"],Ee=()=>({width:"50vw"}),Be=()=>({"1199px":"75vw","575px":"95vw"}),M=t=>({"ng-invalid ng-dirty":t});function Me(t,d){if(t&1){let e=x();n(0,"div",16)(1,"span",17),m(2,"i",18),n(3,"input",19,1),o(5,"translate"),g("input",function(p){f(e),_();let v=k(6);return h(v.filterGlobal(p.target.value,"contains"))}),i()()(),n(6,"p-button",20),o(7,"translate"),g("onClick",function(){f(e);let p=_();return h(p.refresh())}),i(),n(8,"p-button",21),o(9,"translate"),g("onClick",function(){f(e);let p=_();return h(p.openUserDialog("add"))}),i()}if(t&2){_();let e=k(6);r(3),u("placeholder",s(5,4,"Search ..."))("value",e.filters.global==null?null:e.filters.global.value),r(3),u("label",s(7,6,"Refresh")),r(2),u("label",s(9,8,"New"))}}function De(t,d){if(t&1){let e=x();n(0,"p-button",22),o(1,"translate"),g("onClick",function(){f(e);let p=_();return h(p.openUserDialog("edit"))}),i(),n(2,"p-button",23),o(3,"translate"),g("onClick",function(){f(e);let p=_();return h(p.deleteSelectedUser())}),i()}if(t&2){let e=_();u("label",s(1,4,"Edit"))("disabled",!e.selectedUser()),r(2),u("label",s(3,6,"Delete"))("disabled",!e.selectedUser())}}function Ne(t,d){t&1&&(n(0,"tr")(1,"th",24),l(2),o(3,"translate"),i(),n(4,"th",24),l(5),o(6,"translate"),i(),n(7,"th",24),l(8),o(9,"translate"),i(),n(10,"th",24),l(11),o(12,"translate"),i(),n(13,"th",25),l(14),o(15,"translate"),i()(),n(16,"tr")(17,"th"),l(18),o(19,"translate"),i(),n(20,"th"),l(21),o(22,"translate"),i(),n(23,"th"),l(24),o(25,"translate"),i(),n(26,"th"),l(27),o(28,"translate"),i(),n(29,"th"),l(30),o(31,"translate"),i()()),t&2&&(r(2),a(s(3,10,"Username")),r(3),a(s(6,12,"First Name")),r(3),a(s(9,14,"Last Name")),r(3),a(s(12,16,"Last Login")),r(3),a(s(15,18,"Permissions")),r(4),a(s(19,20,"Show Stock")),r(3),a(s(22,22,"Show Cost")),r(3),a(s(25,24,"Edit Invoice")),r(3),a(s(28,26,"Delete Invoice")),r(3),a(s(31,28,"Show Reports")))}function Re(t,d){t&1&&(n(0,"td"),m(1,"i",28),i())}function Pe(t,d){t&1&&(n(0,"td"),m(1,"i",29),i())}function je(t,d){t&1&&(n(0,"td"),m(1,"i",28),i())}function qe(t,d){t&1&&(n(0,"td"),m(1,"i",29),i())}function Le(t,d){t&1&&(n(0,"td"),m(1,"i",28),i())}function Ae(t,d){t&1&&(n(0,"td"),m(1,"i",29),i())}function ze(t,d){t&1&&(n(0,"td"),m(1,"i",28),i())}function Ge(t,d){t&1&&(n(0,"td"),m(1,"i",29),i())}function Oe(t,d){t&1&&(n(0,"td"),m(1,"i",28),i())}function We(t,d){t&1&&(n(0,"td"),m(1,"i",29),i())}function Qe(t,d){if(t&1&&(n(0,"tr",27)(1,"td"),l(2),i(),n(3,"td"),l(4),i(),n(5,"td"),l(6),i(),n(7,"td"),l(8),i(),w(9,Re,2,0,"td")(10,Pe,2,0,"td")(11,je,2,0,"td")(12,qe,2,0,"td")(13,Le,2,0,"td")(14,Ae,2,0,"td")(15,ze,2,0,"td")(16,Ge,2,0,"td")(17,Oe,2,0,"td")(18,We,2,0,"td"),i()),t&2){let e=_().$implicit;u("pSelectableRow",e),r(2),a(e.username),r(2),a(e.first_name||" --- "),r(2),a(e.last_name||" --- "),r(2),a(e.last_login||"Never logged in yet!"),r(),C(e.show_stock?9:10),r(2),C(e.show_cost?11:12),r(2),C(e.edit_invoice?13:14),r(2),C(e.delete_invoice?15:16),r(2),C(e.show_reports?17:18)}}function Ye(t,d){if(t&1&&w(0,Qe,19,10,"tr",26),t&2){let e=d.$implicit;u("ngIf",e.user_type=="user")}}function Ke(t,d){t&1&&(n(0,"tr")(1,"td",30),l(2),o(3,"translate"),i()()),t&2&&(r(2),a(s(3,1,"No records yet!")))}function Je(t,d){if(t&1&&(n(0,"div",33)(1,"label",49),l(2),o(3,"translate"),i(),m(4,"input",50),i()),t&2){let e=_(2);r(2),a(s(3,2,"Password")),r(2),u("ngClass",V(4,M,(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.dirty)||(e.password==null?null:e.password.touched)||e.submitted)))}}function Xe(t,d){if(t&1&&(n(0,"div",33)(1,"label",51),l(2),o(3,"translate"),i(),m(4,"input",52),i()),t&2){let e=_(2);r(2),a(s(3,2,"Confirm Password")),r(2),u("ngClass",V(4,M,(e.confirm_password==null?null:e.confirm_password.invalid)&&((e.confirm_password==null?null:e.confirm_password.dirty)||(e.confirm_password==null?null:e.confirm_password.touched)||e.submitted)))}}function Ze(t,d){if(t&1){let e=x();n(0,"form",31),g("ngSubmit",function(){f(e);let p=_();return h(p.submitUser())}),n(1,"div",32)(2,"div",33)(3,"label",34),l(4),o(5,"translate"),i(),m(6,"input",35,2),i(),w(8,Je,5,6,"div",36)(9,Xe,5,6,"div",36),i(),n(10,"div",32)(11,"div",37)(12,"label",38),l(13),o(14,"translate"),i(),m(15,"input",39),i(),n(16,"div",37)(17,"label",40),l(18),o(19,"translate"),i(),m(20,"input",41),i()(),n(21,"h3"),l(22),o(23,"translate"),i(),n(24,"div",32)(25,"div",42)(26,"label"),l(27),o(28,"translate"),i(),n(29,"div",43),m(30,"p-inputSwitch",44),i()(),n(31,"div",42)(32,"label"),l(33),o(34,"translate"),i(),n(35,"div",43),m(36,"p-inputSwitch",45),i()(),n(37,"div",42)(38,"label"),l(39),o(40,"translate"),i(),n(41,"div",43),m(42,"p-inputSwitch",46),i()(),n(43,"div",42)(44,"label"),l(45),o(46,"translate"),i(),n(47,"div",43),m(48,"p-inputSwitch",47),i()(),n(49,"div",42)(50,"label"),l(51),o(52,"translate"),i(),n(53,"div",43),m(54,"p-inputSwitch",48),i()()()()}if(t&2){let e=_();u("formGroup",e.userForm),r(4),a(s(5,13,"Username")),r(2),u("ngClass",V(31,M,(e.username==null?null:e.username.invalid)&&((e.username==null?null:e.username.dirty)||(e.username==null?null:e.username.touched)||e.submitted))),r(2),u("ngIf",e.dialogMode=="add"),r(),u("ngIf",e.dialogMode=="add"),r(4),a(s(14,15,"First Name")),r(5),a(s(19,17,"Last Name")),r(4),a(s(23,19,"Permissions")),r(5),a(s(28,21,"Show Stock")),r(6),a(s(34,23,"Show Cost")),r(6),a(s(40,25,"Edit Invoice")),r(6),a(s(46,27,"Delete Invoice")),r(6),a(s(52,29,"Show Reports"))}}function $e(t,d){if(t&1){let e=x();n(0,"p-button",53),o(1,"translate"),g("onClick",function(){f(e);let p=_();return h(p.closeUserDialog())}),i(),n(2,"p-button",54),o(3,"translate"),g("onClick",function(){f(e);let p=_();return h(p.submitUser())}),i()}if(t&2){let e=_();u("label",s(1,3,"Cancel")),r(2),u("label",s(3,5,"Save"))("loading",e.loading())}}var Ve=(()=>{class t{constructor(){this.usersService=U(be),this.confirmationService=U(I),this.fb=U(ee),this.translate=U(le),this.subscriptions=new D,this.usersLoading=this.usersService.usersLoading,this.users=this.usersService.users,this.userDialogVisible=this.usersService.userDialogVisible,this.loading=this.usersService.loading,this.selectedUser=this.usersService.selectedUser,this.submitted=!1,this.permissionOptions=[{name:this.translate.instant("Yes"),value:1},{name:this.translate.instant("No"),value:0}],this.userForm=this.fb.group({user_id:[null],username:[null,b.required],password:[null],confirm_password:[null],first_name:[null],last_name:[null],show_stock:[0],show_cost:[0],edit_invoice:[0],delete_invoice:[0],show_reports:[0]})}ngOnInit(){this.usersService.selectedUser.set(null),this.subscriptions.add(this.usersService.existedUsernameError.subscribe(()=>{this.name.nativeElement.select(),this.userForm.controls.username.setErrors({error:"Username already exists"})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}refresh(){this.usersService.getUsers()}get username(){return this.userForm.get("username")}get password(){return this.userForm.get("password")}get confirm_password(){return this.userForm.get("confirm_password")}openUserDialog(e){this.dialogMode=e,this.dialogMode=="add"?this.usersService.userDialogVisible.set(!0):this.dialogMode=="edit"&&(this.userForm.patchValue(this.selectedUser()),this.usersService.userDialogVisible.set(!0))}submitUser(){this.submitted=!0,this.dialogMode=="add"?(this.userForm.controls.password.addValidators([b.required]),this.userForm.controls.confirm_password.addValidators([b.required]),this.userForm.controls.password.updateValueAndValidity(),this.userForm.controls.confirm_password.updateValueAndValidity(),this.userForm.valid&&(this.userForm.value.password===this.userForm.value.confirm_password?this.confirmationService.confirm({key:"users",message:"Are you sure that you want to continue ?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.usersService.loading.set(!0),this.usersService.createUser(this.userForm.value)},reject:()=>{this.submitted=!1}}):(this.userForm.controls.password.setErrors({error:"password didnt match!"}),this.userForm.controls.confirm_password.setErrors({error:"password didnt match!"})))):(this.userForm.controls.password.removeValidators([b.required]),this.userForm.controls.confirm_password.removeValidators([b.required]),this.userForm.controls.password.updateValueAndValidity(),this.userForm.controls.confirm_password.updateValueAndValidity(),this.userForm.valid&&(this.usersService.loading.set(!0),this.usersService.updateUser(this.userForm.value)))}deleteSelectedUser(){this.confirmationService.confirm({key:"users",message:this.translate.instant("Are you sure you want to continue ?"),header:this.translate.instant("Warning"),acceptLabel:this.translate.instant("Yes"),rejectLabel:this.translate.instant("No"),icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.usersService.deleteUser(this.selectedUser())}})}closeUserDialog(){this.usersService.userDialogVisible.set(!1)}resetDialog(){this.submitted=!1,this.usersService.userDialogVisible.set(!1),this.userForm.reset({show_stock:0,show_cost:0,edit_invoice:0,delete_invoice:0,show_reports:0})}selectUser(e){this.usersService.selectedUser.set(e.data)}unselectUser(){this.usersService.selectedUser.set(null)}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275cmp=N({type:t,selectors:[["app-users-home"]],viewQuery:function(c,p){if(c&1&&R(Fe,5),c&2){let v;P(v=j())&&(p.name=v.first)}},decls:16,vars:24,consts:[["dt",""],["tableSearch",""],["name",""],[1,"grid","m-1"],[1,"col-12"],["styleClass","p-2"],["pTemplate","left"],["pTemplate","right"],["styleClass","p-datatable-sm p-datatable-striped","selectionMode","single","dataKey","user_id",3,"onRowSelect","onRowUnselect","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","top","styleClass","p-fluid",3,"visibleChange","onHide","visible","header","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],["key","users"],[1,"flex"],[1,"p-input-icon-left","mr-auto"],[1,"pi","pi-search"],["pInputText","","type","search",1,"p-inputtext-sm",3,"input","placeholder","value"],["icon","pi pi-refresh","styleClass","ml-2","size","small",3,"onClick","label"],["icon","pi pi-plus","severity","success","size","small","styleClass","ml-2",3,"onClick","label"],["icon","pi pi-file-edit","size","small","severity","warning","styleClass","mr-2",3,"onClick","label","disabled"],["icon","pi pi-trash","severity","danger","size","small",3,"onClick","label","disabled"],["rowspan","2"],["colspan","5"],[3,"pSelectableRow",4,"ngIf"],[3,"pSelectableRow"],[1,"pi","pi-check-circle","text-green-600"],[1,"pi","pi-times-circle","text-red-600"],["colspan","9"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],["for","name"],["type","text","pInputText","","formControlName","username","required","","spellcheck","false",3,"ngClass"],["class","field col-12 md:col-4",4,"ngIf"],[1,"field","col-12","md:col-6"],["for","first_name"],["id","first_name","type","text","pInputText","","formControlName","first_name","spellcheck","false"],["for","last_name"],["id","last_name","type","text","pInputText","","formControlName","last_name","spellcheck","false"],[1,"field","col-12","md:col-2"],[1,"flex","align-items-center","gap-1"],["id","show_stock","formControlName","show_stock"],["id","show_cost","formControlName","show_cost"],["id","edit_invoice","formControlName","edit_invoice"],["id","delete_invoice","formControlName","delete_invoice"],["id","show_reports","formControlName","show_reports"],["for","password"],["id","password","type","password","pInputText","","formControlName","password","required","","spellcheck","false",3,"ngClass"],["for","confirm_password"],["id","confirm_password","type","password","pInputText","","formControlName","confirm_password","required","","spellcheck","false",3,"ngClass"],["icon","pi pi-times","severity","secondary","size","small",3,"onClick","label"],["icon","pi pi-check","severity","success","size","small",3,"onClick","label","loading"]],template:function(c,p){if(c&1){let v=x();n(0,"div",3)(1,"div",4)(2,"p-toolbar",5),w(3,Me,10,10,"ng-template",6)(4,De,4,8,"ng-template",7),i(),n(5,"p-table",8,0),g("onRowSelect",function(y){return f(v),h(p.selectUser(y))})("onRowUnselect",function(){return f(v),h(p.unselectUser())}),w(7,Ne,32,30,"ng-template",9)(8,Ye,1,1,"ng-template",10)(9,Ke,4,3,"ng-template",11),i()()(),n(10,"p-dialog",12),o(11,"translate"),A("visibleChange",function(y){return f(v),L(p.userDialogVisible,y)||(p.userDialogVisible=y),h(y)}),g("onHide",function(){return f(v),h(p.resetDialog())}),w(12,Ze,55,33,"ng-template",13)(13,$e,4,7,"ng-template",14),i(),m(14,"p-toast",15)(15,"p-confirmDialog",15)}c&2&&(r(5),u("value",p.users())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(19,He))("alwaysShowPaginator",!1)("globalFilterFields",S(20,ke))("filterDelay",0)("loading",p.usersLoading()),r(5),H(S(21,Ee)),q("visible",p.userDialogVisible),u("header",s(11,17,"User"))("modal",!0)("breakpoints",S(22,Be)),r(5),H(S(23,Ee)))},dependencies:[z,G,J,Q,Y,K,$,X,Z,ue,W,_e,ne,ve,oe,ye,Ce,pe,he,ae]})}}return t})();var et=[{path:"",component:Ve}],Ie=(()=>{class t{static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=E({imports:[B.forChild(et),B]})}}return t})();var zt=(()=>{class t{static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=E({providers:[I],imports:[O,te,ie,Ie,fe,re,we,se,Ue,xe,me,ce,de,Se,ge]})}}return t})();export{zt as UsersModule};
